<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>스캔 서비스 가격 계산기</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --primary: #0d6efd;
      --bg: #f8f9fa;
      --text: #343a40;
      --card-bg: #ffffff;
      --card-hover: rgba(0, 0, 0, 0.1);
      --badge-warning-bg: #ffc107;
      --badge-warning-text: #212529;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --primary: #339af0;
        --bg: #121212;
        --text: #e0e0e0;
        --card-bg: #1e1e1e;
        --card-hover: rgba(255, 255, 255, 0.1);
        --badge-warning-bg: #e09f3e;
        --badge-warning-text: #000000;
      }
    }

    body { font-family: 'Inter', 'Noto Sans KR', sans-serif; background-color: var(--bg); color: var(--text); }
    h1 { font-weight: 700; letter-spacing: -0.5px; }
    .card { background-color: var(--card-bg); transition: transform .2s, box-shadow .2s; }
    .card:hover { transform: translateY(-4px); box-shadow: 0 6px 20px var(--card-hover); }
    .badge-warning { background-color: var(--badge-warning-bg); color: var(--badge-warning-text); }
    .chat-btn { background-color: var(--primary); color: #fff; position: fixed; bottom: 1.5rem; right: 1.5rem; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; box-shadow: 0 4px 12px rgba(0,0,0,0.15); transition: transform .2s; z-index:1000; }
    .chat-btn:hover { transform: scale(1.1); }
    .modal-body pre { white-space: pre-wrap; }
  </style>
</head>

<body>
  <div class="container py-5">
    <div class="row g-4">
      <div class="col-12 text-center"><h1 class="mb-4">스캔 서비스 가격 계산기</h1></div>

      <div class="col-md-6">
        <div class="card h-100 shadow-sm">
          <div class="card-body">
            <h5 class="card-title mb-3"><i class="bi bi-book-half me-2"></i>북스캔 서비스</h5>
            <p class="card-text mb-3">책을 PDF로 만들어 공간을 절약하고, 언제든 편하게 보관하세요!</p>
            <ul class="list-unstyled ps-3 mb-3">
              <li class="mb-2"><i class="bi bi-file-earmark-text me-2"></i>OCR (검색 가능한 PDF 제공)</li>
              <li class="mb-2"><i class="bi bi-aspect-ratio me-2"></i>고해상도(400dpi) 옵션</li>
              <li class="mb-2"><i class="bi bi-percent me-2"></i>대량 스캔 할인</li>
              <li class="mb-2"><i class="bi bi-cloud-upload me-2"></i>이메일 · 클라우드 전달</li>
              <li class="mb-2"><i class="bi bi-clock-history me-2"></i>영도 지역 저녁 수령 가능</li>
            </ul>
            <span class="badge badge-warning">주의: 가로폭 240mm 이상 스캔 불가</span>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="card h-100 shadow-sm d-flex flex-column justify-content-between">
          <div class="card-body">
            <h5 class="card-title mb-3"><i class="bi bi-folder2-open me-2"></i>샘플 파일</h5>
            <p class="card-text mb-4">다양한 해상도와 OCR 샘플을 확인해보세요.</p>
          </div>
          <div class="card-footer bg-transparent border-0">
            <div class="d-grid gap-2">
              <a href="sample/300dpi_sample.pdf" target="_blank" class="btn btn-outline-primary">300dpi 샘플</a>
              <a href="sample/400dpi_sample.pdf" target="_blank" class="btn btn-outline-primary">400dpi 샘플</a>
              <a href="sample/ocr_sample.pdf" target="_blank" class="btn btn-outline-primary">OCR 샘플</a>
            </div>
          </div>
        </div>
      </div>

      <div class="col-12">
        <div class="card shadow-sm">
          <div class="card-body">
            <div class="d-flex mb-3 justify-content-between align-items-center flex-wrap">
              <h5 class="card-title mb-2"><i class="bi bi-calculator me-2"></i>가격 계산</h5>
              <div class="btn-group mb-2">
                <button class="btn btn-success" onclick="addRow()"><i class="bi bi-plus-lg me-1"></i>줄 추가</button>
                <button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#estimateModal" onclick="prepareEstimate()"><i class="bi bi-clipboard me-1"></i>견적서 복사</button>
              </div>
              <div id="discountInfo" class="fs-6 text-danger mb-2"></div>
              <div id="result" class="fs-4 fw-semibold text-primary mb-2">총 가격: 0원</div>
            </div>
            <div class="table-responsive mb-3">
              <table class="table table-bordered align-middle text-center" id="bookTable">
                <thead class="table-light">
                  <tr><th>권 수</th><th>쪽 수</th><th>OCR</th><th>고해상도</th><th>개별 가격</th><th>삭제</th></tr>
                </thead>
                <tbody>
                  <tr>
                    <td><input type="number" class="form-control bookCount" min="1" value="1"></td>
                    <td><input type="number" class="form-control pageCount" min="1" value="100"></td>
                    <td><input type="checkbox" class="form-check-input ocr"></td>
                    <td><input type="checkbox" class="form-check-input highRes"></td>
                    <td class="individualPrice">3000원</td>
                    <td><button class="btn btn-sm btn-danger" onclick="removeRow(this)">삭제</button></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- 견적서 모달 -->
  <div class="modal fade" id="estimateModal" tabindex="-1" aria-labelledby="estimateModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="estimateModalLabel">견적서</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="닫기"></button>
        </div>
        <div class="modal-body">
          <pre id="estimateContent"></pre>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" onclick="copyEstimate()">클립보드에 복사</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 플로팅 채팅 버튼 -->
  <a href="https://open.kakao.com/o/saMv4uCh" target="_blank" class="chat-btn"><i class="bi bi-chat-dots-fill"></i></a>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    let lastEstimateText = '';
    document.addEventListener("DOMContentLoaded", calculatePrice);
    document.getElementById("bookTable").addEventListener("input", calculatePrice);
    document.getElementById("bookTable").addEventListener("change", calculatePrice);

    function addRow() {
      const tbody = document.querySelector("#bookTable tbody");
      const newRow = tbody.rows[0].cloneNode(true);
      newRow.querySelectorAll("input").forEach(input => { if (input.type === "number") input.value = input.classList.contains("bookCount") ? 1 : 100; if (input.type === "checkbox") input.checked = false; });
      newRow.querySelector(".individualPrice").innerText = "3000원";
      tbody.appendChild(newRow);
      calculatePrice();
    }

    function removeRow(btn) {
      const tbody = document.querySelector("#bookTable tbody"); if (tbody.rows.length > 1) btn.closest("tr").remove(); calculatePrice();
    }

    function calculatePrice() {
      let total = 0, totalBase = 0, bookSum = 0;
      document.querySelectorAll("#bookTable tbody tr").forEach(row => {
        const c = +row.querySelector(".bookCount").value;
        const p = +row.querySelector(".pageCount").value;
        const o = row.querySelector(".ocr").checked;
        const h = row.querySelector(".highRes").checked;
        let base = 0;
        for (let i = 0; i < c; i++) {
          let price = 3000 + (p > 100 ? Math.ceil((p - 100)/100)*2000 : 0);
          if (o) price += 2000;
          if (h) price += 2000;
          base += price;
        }
        row.querySelector(".individualPrice").innerText = `${Math.round(base)}원`;
        totalBase += base; total += base; bookSum += c;
      });
      let discountRate = 0;
      if (bookSum >= 10) discountRate = 0.2;
      else if (bookSum >= 5) discountRate = 0.1;
      const discountAmount = Math.round(totalBase * discountRate);
      total = Math.round(totalBase * (1 - discountRate));
      document.getElementById("result").innerText = `총 가격: ${total}원`;
      document.getElementById("discountInfo").innerText = discountRate > 0 ? `할인율: ${discountRate*100}% 적용 (절약 ${discountAmount}원)` : '';
    }

    function prepareEstimate() {
      calculatePrice();
      let text = "[북스캔 서비스 견적서]\n";
      document.querySelectorAll("#bookTable tbody tr").forEach((row, idx) => {
        const c = row.querySelector(".bookCount").value;
        const p = row.querySelector(".pageCount").value;
        const o = row.querySelector(".ocr").checked ? 'OCR ' : '';
        const h = row.querySelector(".highRes").checked ? '고해상도 ' : '';
        const price = row.querySelector(".individualPrice").innerText;
        text += `줄 ${idx+1}: ${c}권, ${p}쪽, 옵션: ${o}${h}, 가격: ${price}\n`;
      });
      const summary = document.getElementById("result").innerText;
      const discountLine = document.getElementById("discountInfo").innerText;
      text += summary + (discountLine ? ` (${discountLine})` : '') + '\n';
      document.getElementById("estimateContent").innerText = text;
      lastEstimateText = text;
    }

    function copyEstimate() {
      navigator.clipboard.writeText(lastEstimateText).then(() => {
        alert('견적서가 클립보드에 복사되었습니다.');
      });
    }
  </script>
</body>

</html>
